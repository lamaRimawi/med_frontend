// Helper methods to add to TimelineScreen

  // Convert TimelineReport to MedicalRecord for UI
  List<MedicalRecord> _convertToMedicalRecords() {
    return _timelineReports.map((report) {
      final date = DateTime.parse(report.date);
      final monthNames = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
      
      return MedicalRecord(
        id: report.reportId,
        date: '${monthNames[date.month - 1]} ${date.day}',
        time: '',
        fullDate: _formatFullDate(date),
        title: report.reportType,
        type: report.reportType,
        category: _getCategoryFromType(report.reportType),
        facility: '',
        doctor: report.doctorNames ?? '',
        status: report.summary.abnormalCount > 0 ? 'Review Required' : 'Normal',
        timestamp: date,
        notes: report.summary.abnormalCount == 0
            ? 'All ${report.summary.totalTests} test(s) within normal range.'
            : '${report.summary.abnormalCount} abnormal: ${report.summary.abnormalFields.join(", ")}',
        values: null,
      );
    }).toList();
  }
  
  String _formatFullDate(DateTime date) {
    const days = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday'];
    const months = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];
    return '${days[date.weekday - 1]}, ${months[date.month - 1]} ${date.day}, ${date.year}';
  }
  
  String _getCategoryFromType(String type) {
    final lower = type.toLowerCase();
    if (lower.contains('lab') || lower.contains('test') || lower.contains('blood')) return 'lab';
    if (lower.contains('x-ray') || lower.contains('scan') || lower.contains('imaging')) return 'imaging';
    if (lower.contains('prescription') || lower.contains('medication')) return 'prescription';
    return 'other';
  }
